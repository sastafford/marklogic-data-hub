<!doctype html> <!--[if lt IE 7 ]><html itemscope itemtype="http://schema.org/Organization" id="ie6" class="ie ie-old" lang="en-US"><![endif]--><!--[if IE 7 ]><html itemscope itemtype="http://schema.org/Organization" id="ie7" class="ie ie-old" lang="en-US"><![endif]--><!--[if IE 8 ]><html itemscope itemtype="http://schema.org/Organization" id="ie8" class="ie ie-old" lang="en-US"><![endif]--><!--[if IE 9 ]><html itemscope itemtype="http://schema.org/Organization" id="ie9" class="ie" lang="en-US"><![endif]--><!--[if gt IE 9]><!--><html itemscope itemtype="http://schema.org/Organization" lang="en-US"><!--<![endif]--><head><meta charset="utf-8"><title>Getting Started Tutorial - MarkLogic Data Hub Framework</title><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta content="yes" name="apple-mobile-web-app-capable"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64 96x96" href="/marklogic-data-hub/favicon.ico"><link rel="apple-touch-icon" sizes="57x57" href="/marklogic-data-hub/img/favicons/favicon-57.png"><link rel="apple-touch-icon-precomposed" sizes="57x57" href="/marklogic-data-hub/img/favicons/favicon-57.png"><link rel="apple-touch-icon" sizes="60x60" href="/marklogic-data-hub/img/favicons/favicon-60.png"><link rel="apple-touch-icon" sizes="72x72" href="/marklogic-data-hub/img/favicons/favicon-72.png"><link rel="apple-touch-icon" sizes="76x76" href="/marklogic-data-hub/img/favicons/favicon-76.png"><link rel="apple-touch-icon" sizes="96x96" href="/marklogic-data-hub/img/favicons/favicon-96.png"><link rel="apple-touch-icon" sizes="114x114" href="/marklogic-data-hub/img/favicons/favicon-114.png"><link rel="apple-touch-icon" sizes="120x120" href="/marklogic-data-hub/img/favicons/favicon-120.png"><link rel="apple-touch-icon" sizes="144x144" href="/marklogic-data-hub/img/favicons/favicon-144.png"><link rel="apple-touch-icon" sizes="152x152" href="/marklogic-data-hub/img/favicons/favicon-152.png"><link rel="apple-touch-icon" sizes="180x180" href="/marklogic-data-hub/img/favicons/favicon-180.png"><link rel="apple-touch-icon" sizes="192x192" href="/marklogic-data-hub/img/favicons/favicon-192.png"><meta name="application-name" content="MarkLogic Data Hub Framework - A data hub framework for MarkLogic"><meta name="msapplication-TileImage" content="/marklogic-data-hub/img/favicons/favicon-144.png"><meta name="msapplication-TileColor" content="#ffffff"></head><body class=""><nav class="navbar navbar-inverse navbar-fixed-top"><div class="container-fluid"><div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/"> <span class="logo"> <img src="/marklogic-data-hub/images/logo-marklogic.svg" width="150px" height="36px" alt="MarkLogic" title="MarkLogic" scale="0"> </span> MarkLogic Data Hub Framework </a></div><div id="navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li> <a href="/marklogic-data-hub/">Getting Started</a></li><li> <a href="/marklogic-data-hub/what">What?</a></li><li> <a href="/marklogic-data-hub/how">How?</a></li><li> <a href="https://github.com/marklogic/marklogic-data-hub">Fork on GitHub</a></li></ul></div></div> </nav><div class="title-group"><h1 class="special"> <span> Getting Started Tutorial </span></h1><p class="lead"></p></div><article><div class="container"><div class="row"><div class="col-md-10 col-md-offset-1"><h2 id="building-an-hr-hub">Building an HR Hub</h2><p>This tutorial will walk you through setting up a very simple hub for HR data. Your company Global Corp has provided you with CSV dumps of 3 tables. Additionally you are receiving JSON data files from a recently acquired company Acme Tech. You are responsible for loading data from both systems into your data hub to make them accessible to internal systems.</p><h3 id="in-a-hurry">In a Hurry?</h3><p>The finished version of this tutorial is available for you to download and play with. <a href="https://github.com/marklogic/marklogic-data-hub/tree/master/examples/hr-hub" target="_blank">Finished HR Hub Example</a></p><h3 id="quickstart">QuickStart</h3><p>This tutorial uses quickStart, a simple User Interface that you can run locally to start working with the Data Hub quickly. With QuickStart you will have a working hub in a matter of minutes. No need to worry about deployment strategies or configuration details. Simply run the war and point it at your MarkLogic installation.</p><h2 id="prerequisites">Prerequisites</h2><p>Before you can run the hub you will need to have some some software installed.</p><ul><li><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java 8</a></li><li><a href="http://developer.marklogic.com/products">MarkLogic 8.02+</a></li></ul><h2 id="download-and-install-marklogic">1 - Download and Install MarkLogic</h2><p>Follow the instructions <a href="https://docs.marklogic.com/guide/installation" target="_blank">here</a> for installing MarkLogic.</p><iframe width="420" height="315" src="https://www.youtube.com/embed/WaRi9HMtz5Q" frameborder="0" allowfullscreen=""></iframe><h2 id="download-the-quickstart-war">2 - Download the QuickStart War</h2><ul><li>Create a folder for this hub project and cd into it.</li></ul><div class="highlighter-rouge"><pre class="highlight"><code>mkdir data-hub
<span class="nb">cd </span>data-hub
</code></pre></div><ul><li>Download the quick-start-*.war from the <a href="https://github.com/marklogic/marklogic-data-hub/releases/latest" target="_blank">releases page</a> and place it in the folder you just created.</li></ul><h2 id="download-the-sample-data">3 - Download the Sample Data</h2><ul><li>Create a folder to hold your input data</li></ul><div class="highlighter-rouge"><pre class="highlight"><code>mkdir input
</code></pre></div><ul><li>Download the <a href="/marklogic-data-hub/data/hr-data.zip" target="_blank">Zip file of sample data</a> into the <strong>input</strong> folder you just created. Now extract it.</li></ul><p>Your directory should look like this:</p><p><img src="/marklogic-data-hub/images/dir-tree.png" alt="Directory Tree"/></p><h2 id="run-the-quickstart">4 - Run the QuickStart</h2><ul><li>Open a terminal window in the data-hub directory</li><li>Run the War</li></ul><div class="highlighter-rouge"><pre class="highlight"><code>java -jar quick-start-<span class="k">*</span>.war
</code></pre></div><ul><li>Open the QuickStart Application in your browser: <a href="http://localhost:8080" target="_blank">http://localhost:8080</a></li></ul><h2 id="login-to-the-hub">5 - Login to the Hub</h2><p>After opening the QuickStart Application you must step through a wizard to properly configure the Hub.</p><p>Browse to the directory where your hub where live. <img src="/marklogic-data-hub/images/hub-wizard-1.png" alt="Hub Directory"/></p><p>Initialize your Data Hub Project Directory. <img src="/marklogic-data-hub/images/hub-wizard-2.png" alt="Hub Directory"/></p><p>Click Next. <img src="/marklogic-data-hub/images/hub-wizard-3.png" alt="Hub Directory"/></p><p>Choose the Local Environment. <img src="/marklogic-data-hub/images/hub-wizard-4.png" alt="Hub Directory"/></p><p>Login to the Hub with your MarkLogic credentials <img src="/marklogic-data-hub/images/hub-wizard-5.png" alt="Hub Directory"/></p><p>Install the Hub into MarkLogic <img src="/marklogic-data-hub/images/hub-wizard-6.png" alt="Hub Directory"/></p><p>Click Finished <img src="/marklogic-data-hub/images/hub-wizard-7.png" alt="Hub Directory"/></p><h2 id="create-your-first-entity">6 - Create Your First Entity</h2><p>Entities are the business objects that you will be working with in the hub. Start by defining a new Entity for Employees. Click the <strong>New Entity</strong> button. Now fill out the popup with your entity name. If you are using the example code we provide then make sure to name this “Employees”.</p><p><img src="/marklogic-data-hub/images/create-employee.png" alt="New Entity"/></p><p>You have just created an Entity.</p><h2 id="create-your-first-flows">7 - Create Your First Flows</h2><blockquote><p><strong>Input Flows</strong> are responsible for getting data into the Hub staging area.</p></blockquote><blockquote><p><strong>Harmonize Flows</strong> are responsible for batch transformation of data from staging to final.</p></blockquote><p>First you will create an Input and Harmonize flow for Acme Tech. Start by clicking the Employee Entity to expand it. Now click the <strong>+</strong> button next to the Input Flows then fill out the form.</p><p>Name the flow <strong>“load-acme-tech”</strong> and leave the default values for Plugin Type and Data Format.</p><p><img src="/marklogic-data-hub/images/create-acme-tech-1.png" alt="New Acme Tech Flows"/></p><p>Now click the <strong>+</strong> button next to the Harmonize Flows then fill out the form. Name the flow <strong>“harmonize-acme-tech”</strong> and leave the default values for Plugin Type and Data Format.</p><p><img src="/marklogic-data-hub/images/create-acme-tech-2.png" alt="New Acme Tech Flows"/></p><p><strong>** It’s important to keep the names the same if you plan on using our code examples. The code examples are performing collection queries tied to the names of these flows.</strong></p><p>Next you will want to create an Input and Harmonize flow for Global Corp. Start by clicking the <strong>+</strong> button next to Input Flows. Then fill out the form. Name the flow <strong>“load-global-corp”</strong> and leave the default values for Plugin Type and Data Format.</p><p><img src="/marklogic-data-hub/images/create-global-corp-1.png" alt="New Acme Tech Flows"/></p><p>Now click the <strong>+</strong> button next to the Harmonize Flows then fill out the form. Name the flow <strong>“harmonize-global-corp”</strong> and leave the default values for Plugin Type and Data Format.</p><p><img src="/marklogic-data-hub/images/create-global-corp-2.png" alt="New Acme Tech Flows"/></p><p>The Quick Start application automatically deploys your flows to the server for you any time you make a change. You can manually force a redeploy by pressing the Redeploy Button at the bottom left of the screen.</p><h2 id="ingest-acme-tech-data">8 - Ingest Acme Tech Data</h2><p>Now that your entity is created you want to ingest some data. QuickStart uses the <a href="https://docs.marklogic.com/guide/mlcp" target="_blank">MarkLogic Content Pump</a> to ingest data.</p><ol><li>Click on the <strong>load-acme-tech</strong> input flow to highlight it.</li><li><p>Now click on the “Run Flow” button in the right pane. You will see a screen that allows you to configure your MLCP run. <img src="/marklogic-data-hub/images/load-acme-tech-1.png" alt="Click Acme Tech"/></p></li><li>Point the browser box to the input/AcmeTech directory. <img src="/marklogic-data-hub/images/load-acme-tech-2.png" alt="Browse to Input Folder"/></li><li>Expand the <strong>General Options</strong> section.</li><li>Make sure the <strong>Documents</strong> Data Format is selected. <img src="/marklogic-data-hub/images/load-acme-tech-3.png" alt="Choose Documents"/></li><li>Now scroll down and press the “Run Import” button. <img src="/marklogic-data-hub/images/load-acme-tech-4.png" alt="Run Acme Tech"/></li></ol><p>QuickStart will kick off a <a href="https://docs.marklogic.com/guide/mlcp">MarkLogic Content Pump</a> job to ingest the Json documents. You can monitor the progress of the job by navigating to the Jobs tab and clicking on the “Show Console Output” button next to the Job. <img src="/marklogic-data-hub/images/view-acme-tech-job-output.png" alt="View Acme Tech Job Output"/></p><h2 id="ingest-global-corp-data">9 - Ingest Global Corp Data</h2><p>Now you need to load the data for Global Corp.</p><ol><li>Click on the <strong>load-global-corp</strong> input flow to highlight it.</li><li>Now click on the “Run Flow” button in the right pane. You will see a screen that allows you to configure your MLCP run. <img src="/marklogic-data-hub/images/load-global-corp-1.png" alt="Click Global Corp"/></li><li>Point the browser box to the input/GlobalCorp directory. <img src="/marklogic-data-hub/images/load-global-corp-2.png" alt="Browse to Input Folder"/></li><li>Expand the General Options section.</li><li>Choose the <strong>Delimited Text</strong> Data Format. <img src="/marklogic-data-hub/images/load-global-corp-3.png" alt="Choose Delimited Text"/></li><li>Change <strong>Document Type</strong> to <strong>json</strong>. <img src="/marklogic-data-hub/images/load-global-corp-4.png" alt="Choose Json"/></li><li>Expand the <strong>Delimited Text Options</strong> section.</li><li>Check the <strong>Generate URI?</strong> option. <img src="/marklogic-data-hub/images/load-global-corp-5.png" alt="Click Generate URI"/></li><li>Now scroll down and press the “Run Import” button. <img src="/marklogic-data-hub/images/load-global-corp-6.png" alt="Click Global Corp"/></li></ol><p>QuickStart will kick off a <a href="https://docs.marklogic.com/guide/mlcp">MarkLogic Content Pump</a> job to ingest the Json documents. You can monitor the progress of the job by navigating to the Jobs tab and clicking on the “Show Console Output” button next to the Job.</p><p><img src="/marklogic-data-hub/images/load-global-corp-7.png" alt="Monitor Job Progress"/></p><h2 id="prep-for-harmonize">10 - Prep for Harmonize</h2><p>All of our data is loaded into the staging area. While it’s possible to harmonize the data right now it’s not very useful. The out of the box harmonize plugins will simply copy the staging data to the final data area.</p><p>We are going to enhance the data a bit so that it can be more easily searched and accessed. To do this we will identify some commonalities between our two data sets and choose a few fields to extract into the header section of our final envelopes.</p><p>For this tutorial we will pull out 3 headers:</p><ul><li>employee id</li><li>hire date</li><li>salary</li></ul><p>Because we are dealing with two separate data sources we will put the logic for each source into its own flow.</p><h3 id="acme-tech-collector">Acme Tech Collector</h3><p>For Acme Tech we want to return a list of URIs. Since the Acme Tech data came to us as JSON documents, there is only one document for every employee.</p><p>Use your favorite text editor to open the data-hub/plugins/entities/Employee/harmonize/harmonize-acme-tech/collector/collector.sjs file. Replace its contents with this:</p><div class="embed-git" href="//raw.githubusercontent.com/marklogic/marklogic-data-hub/master/examples/hr-hub/plugins/entities/Employee/harmonize/harmonize-acme-tech/collector/collector.sjs"></div><h3 id="acme-tech-header-plugin">Acme Tech header plugin</h3><p>Use your favorite text editor to open the data-hub/plugins/entities/Employee/harmonize/harmonize-acme-tech/headers/headers.sjs file. Replace its contents with this:</p><div class="embed-git" href="//raw.githubusercontent.com/marklogic/marklogic-data-hub/master/examples/hr-hub/plugins/entities/Employee/harmonize/harmonize-acme-tech/headers/headers.sjs"></div><h3 id="global-corp-collector">Global Corp Collector</h3><p>The collector is a plugin that provides a list of items to the Harmonize flow to be acted upon. By default the out of the box collector will return all document URIs in the system. We need to change this. For Global Corp we want to return a list of Employee IDs. This allows us to iterate over each employee ID and create an employee document per ID.</p><p>Use your favorite text editor to open the data-hub/plugins/entities/Employee/harmonize/harmonize-global-corp/collector/collector.sjs file. Replace its contents with this:</p><div class="embed-git" href="//raw.githubusercontent.com/marklogic/marklogic-data-hub/master/examples/hr-hub/plugins/entities/Employee/harmonize/harmonize-global-corp/collector/collector.sjs"></div><h3 id="global-corp-content-plugin">Global Corp Content Plugin</h3><p>For Global corp we are going to use the harmonize step to recreate employee records for every employee ID that is in our staging area. Recall that for the collector we are returning employee IDs instead of URIs. Open up your favorite text editor to the data-hub/plugins/entities/Employee/harmonize/harmonize-global-corp/content/content.sjs file. Replace its contents with this:</p><div class="embed-git" href="//raw.githubusercontent.com/marklogic/marklogic-data-hub/master/examples/hr-hub/plugins/entities/Employee/harmonize/harmonize-global-corp/content/content.sjs"></div><h3 id="global-corp-header-plugin">Global Corp Header Plugin</h3><p>Use your favorite text editor to open the data-hub/plugins/entities/Employee/harmonize/harmonize-global-corp/headers/headers.sjs file. Replace its contents with this:</p><div class="embed-git" href="//raw.githubusercontent.com/marklogic/marklogic-data-hub/master/examples/hr-hub/plugins/entities/Employee/harmonize/harmonize-global-corp/headers/headers.sjs"></div><h2 id="harmonize-the-data">11 - Harmonize the data</h2><p>You ingested your data. You created plugins that will extract common fields into the headers. You edited the collectors to only operate on certain data. Now you are ready to harmonize. Simply press the <strong>Run</strong> button next to both harmonize flows.</p><p>Running Acme Tech <img src="/marklogic-data-hub/images/run-acme-tech.png" alt="Run Harmonize Flow"/></p><p>Running Global Corp <img src="/marklogic-data-hub/images/run-global-corp.png" alt="Run Harmonize Flow"/></p><p>As with the Input Flows you can see the job status in the Jobs tab.</p><h2 id="consume-the-data">12 - Consume the Data</h2><p>Now you can access your data via several REST endpoints. Your harmonized data is available on the Final HTTP server. The defaul port is 8011. A full list of REST endpoints is available here: <a href="https://docs.marklogic.com/REST/client" target="_blank">https://docs.marklogic.com/REST/client</a></p><p>Open the <a href="http://localhost:8010/v1/search?format=json" target="_blank">Staging Search Endpoint</a> against your local instance.</p><p>Open the <a href="http://localhost:8011/v1/search?format=json" target="_blank">Final Search Endpoint</a> against your local instance.</p><p><em>Picture here is the Final Search endpoint.</em> <img src="/marklogic-data-hub/images/rest-screenshot.png" alt="Rest Search"/></p><h2 id="wrapping-up">13 - Wrapping Up</h2><p>Congratulations! You just created a Data Hub.</p><ul><li>You loaded JSON and CSV files.</li><li>You harmonized your data by extracting common header fields.</li><li>Your data is now fully accessible via the <a href="https://docs.marklogic.com/REST/client" target="_blank">MarkLogic REST API</a></li></ul></div></div></div> </article><footer class="site-footer"><div class="container"><div class="row"><div class="col-md-12"><p class="text-muted">Copyright © 2016 MarkLogic Corporation. All Rights Reserved. MARKLOGIC® is a registered trademark of MarkLogic Corporation.</p></div></div></div> </footer><link rel="stylesheet" href="/marklogic-data-hub/css/style.css"> <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script><script src="/marklogic-data-hub/js/respond.min.js"></script><![endif]--><script src="/marklogic-data-hub/assets/bundle.js" id="1"></script><script>!function(e,t,a,n,c,s,o){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,s=t.createElement(a),o=t.getElementsByTagName(a)[0],s.async=1,s.src=n,o.parentNode.insertBefore(s,o)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-79716597-1","auto"),ga("send","pageview")</script></body></html>